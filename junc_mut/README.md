# print_module

[![License: GPL v3](https://img.shields.io/badge/License-GPL%20v3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)
[![Build Status](https://travis-ci.org/ni6o6/asj_mutation.svg?branch=devel)](https://travis-ci.org/ni6o6/asj_mutation)

Utility functions for analyzing splicing junction (generated by STAR, .SJ.out.tab files)

## Dependency

### Require install
`pysam`, [`junc_utils`](https://github.com/friend1ws/junc_utils) packages.

## Install

```
pip install asj_mutation <Now not available.>
```

Alternatively, you can install from the source code <Now not available.>
```
wget https://github.com/ni6o6//.tar.gz 
tar zxvf .tar.gz 
cd 
python setup.py build install
```

This package has been tested on Python 3.7.

## Preparation of input files
the folder: ./junction/
file: sample.SJ.out.tab from STAR.

format:
chr<tab>intron start position<tab>intron end position<tab>0<tab>0<tab>0<tab>reads<tab>reads<tab>score
1	11845	12009	1	1	0	0	2	47
1	12722	13220	1	1	1	0	3	50

## Preparation of control files.
format:
chr<tab>start postion<tab>end position(<tab>any..)

## Commands

sh run_asj_mutation --control_file1 control1.bed.gz --control_file2 control2.bed.gz

format of control files.
chr<tab>start postion<tab>end position(<tab>any..)

### fitler and annotation

filter out splicing junctions outside specified conditions
```
junc_utils filter --pooled_control_file file input output
                     SJ_control_2_4.bed.gz 
                     input(./junction/sample.SJ.out.tab) 
				     output(./alterativeSJ_filtered_annot/sample.SJ.filx1.txt)

junc_utils filter --pooled_control_file file input output
					26common2_hg19_20190606v2.bed.gz 
					input(./junction/sample.SJ.out.tab) 
					output(./alterativeSJ_filtered_annot/sample.SJ.filx2.txt)

```

### annotation

annotate splicing junctions
```
junc_utils annotate input output --genome_id hg19
					input(./alterativeSJ_filtered_annot/sample.SJ.filx2.txt)
					output(./alterativeSJ_filtered_annot/sample.SJ.filx2.annot.txt)
```

### extraction by annotation

extract alterative 5'SS and 3'SS splicing junctions.
ajustment of intron start and end.
```
asj_ass_adj_bed input output
					input (./alterativeSJ_filtered_annot/*.SJ.filtered.annot.txt)
					output (./alterativeSJ_adjustment/%s.SJ.filtered.annot.ass.adj.bed)

```

python SJ_Freq.py

python SJ_tabix_hg19.py

python SJ_extract_canonicalMut.py
		
#after mpileup
#python SJ_annot_mpileup.py

